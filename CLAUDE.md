# 要件定義駆動開発ガイド

このプロジェクトは**要件定義駆動開発**を再現性高く行うためのスターターキットです。

## 開発フロー

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  1. 顧客情報収集        docs/customer/                          │
│     ─────────────       ・やりとりテキスト                       │
│                         ・見積書                                │
│                         ・要件定義書                            │
│           │                                                     │
│           ▼                                                     │
│  2. 設計書作成          /skills で設計書を生成                   │
│     ─────────────       ・Claude Code用に最適化                 │
│                         ・機能ごと・UI毎に分割                   │
│           │                                                     │
│           ▼                                                     │
│  3. 設計書保存          docs/design/                            │
│     ─────────────       ・index.md（全体像）                    │
│                         ・機能別mdファイル                       │
│                         ・UI別mdファイル                         │
│           │                                                     │
│           ▼                                                     │
│  4. コーディング        設計書を元に実装開始                     │
│     ─────────────                                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## ディレクトリ構成

```
docs/
├── customer/                    # 顧客情報
│   ├── meeting-notes/           # 打ち合わせメモ
│   ├── estimates/               # 見積書
│   └── requirements/            # 要件定義書
│
└── design/                      # 設計書（Claude Code用）
    ├── index.md                 # 設計書インデックス（全体像）
    ├── features/                # 機能設計
    │   ├── auth.md              # 認証機能
    │   ├── user-management.md   # ユーザー管理
    │   └── ...
    └── ui/                      # UI設計
        ├── layouts.md           # レイアウト
        ├── components.md        # コンポーネント
        └── ...
```

---

## Skills（設計書作成支援）

`.claude/skills/` に設計書作成用のスキルを配置します。

### スキルの役割

1. **顧客情報の整理** - `docs/customer/`の情報を読み取り、要件を整理
2. **設計書の生成** - Claude Code用に最適化された設計書を作成
3. **設計書の分割** - 機能ごと・UI毎にmdファイルを生成

### 設計書作成の注意点

- **明確な構造**: 機能ごとに独立したmdファイル
- **実装可能な粒度**: Claude Codeが一度に処理できるサイズ
- **依存関係の明示**: 他の機能・ファイルとの関係を記載
- **テスト観点**: 期待する動作・エッジケースを記載

---

## 設計書フォーマット（推奨）

### `docs/design/index.md`

```markdown
# プロジェクト設計書

## 概要
[プロジェクトの目的・背景]

## 機能一覧
- [ ] 機能A → features/feature-a.md
- [ ] 機能B → features/feature-b.md

## UI一覧
- [ ] 画面A → ui/screen-a.md
- [ ] 画面B → ui/screen-b.md

## 技術スタック
[使用技術の一覧]

## データベース設計
[テーブル一覧・ER図]
```

### `docs/design/features/[機能名].md`

```markdown
# 機能名

## 概要
[この機能の目的]

## 要件
- 要件1
- 要件2

## 実装ファイル
- `lib/actions/xxx.ts`
- `lib/db/schemas/xxx.ts`

## API/Server Actions
[関数名・引数・戻り値]

## テスト観点
- 正常系: ...
- 異常系: ...
```

---

## 実行方法

以下のコマンドでスキルが起動し、自律的に最後まで実行します。

| コマンド | 起動スキル | 説明 |
|---------|-----------|------|
| 「要件定義駆動開発を開始して」 | `/design-cycle` | **設計→実装→テスト→セキュリティ診断**まで一気通貫 |
| 「設計書を作成して」 | `/design-doc` | 個別の設計書を作成 |
| 「実装して」 | `/implement` | 設計書に基づき実装 |
| 「バグ修正して」 | `/bug-fix` | バグ調査・修正 |
| 「DBマイグレーションして」 | `/db-migrate` | スキーマ変更・マイグレーション |
| 「セキュリティ監査して」 | `/security-audit` | セキュリティチェック |

### `/design-cycle` の実行フロー

```
Phase 1: 顧客情報探索 → Phase 2: 設計計画 → Phase 3: 設計書作成
    → Phase 4: 設計検証 → Phase 5: 実装 → Phase 6: テスト実行
    → Phase 7: セキュリティ診断 → Phase 8: 完了報告
```

### 前提条件

- `docs/customer/` に顧客情報（要件定義書・打ち合わせメモ等）を配置済みであること

---

## コーディング開始時の手順

1. `docs/design/index.md` を読み込む
2. 実装対象の機能mdファイルを確認
3. 依存関係を確認（他機能・既存コード）
4. 実装 → テスト → 設計書のチェックリスト更新

---

## 全般事項

- 日本語で対応してください
- 複雑なロジックや設計判断の際は英語で思考し、出力は日本語でお願いします
- ファイル内容の編集は、参照関係を調査してから行ってください
- ファイル内容の編集後は、ロジックの破綻がないか調査して報告してください
